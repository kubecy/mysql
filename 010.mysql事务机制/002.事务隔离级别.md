# 事务隔离级别

## 1.隔离级别介绍

1. 事务隔离级别定义了一个事务在执行过程中对其他事务的可见性和干扰程度。SQL 标准定义了四种主要的事务隔离级别。从低到高分别是：

   - **读未提交 (Read Uncommitted)**：允许一个事务读取另一个未提交事务的修改。可能导致“脏读”，即读取到不一致的数据。
     - 问题：脏读、不可重复读、幻读都可能发生。
     - 实际应用：由于性能问题和潜在的数据一致性问题，这种隔离级别在实际应用中很少使用。
   - **读已提交 (Read Committed)**：一个事务只能读取已提交事务的数据。可以避免脏读，但可能出现“不可重复读”，即在同一事务中多次读取同一数据可能得到不同的结果。
     - 问题：虽然避免了脏读，但同一个事务内多次读取同一数据集合时，由于其他事务的提交，导致读取的数据可能不一致，即不可重复读。
   - **可重复读 (Repeatable Read)**：保证在同一个事务中多次读取同样记录的结果是一致的。这是MySQL的默认隔离级别。
     - 问题：解决了脏读和不可重复读的问题，但可能会遇到幻读。
     - 实现机制：MySQL的InnoDB存储引擎通过多版本并发控制（MVCC）和Next-Key Locks机制来实现可重复读，避免了幻读的发生（在大多数情况下）。
   - **串行化 (Serializable)**：最高的隔离级别，它通过强制事务串行执行，避免了脏读、不可重复读和幻读。
     - 问题：性能开销较大，因为它要求事务按顺序执行，可能导致较低的并发性。

2. MySQL的四种隔离级别从上到下，隔离强度逐渐增强，但执行效率逐渐降低。因为隔离级别越低，事务请求的锁越少，所以大部分数据库系统的隔离级别都是READ-COMMITTED(读取提交内容):，但是你要知道的是InnoDB 存储引擎默认使用 REPEATABLE-READ（可重读）并不会有任何性能损失。在实际应用中，需要根据具体场景和需求选择合适的隔离级别，以平衡数据一致性和系统性能。

   ### 1.1.设置事务隔离级别

   ~~~sql
   # 设置事务隔离级别
   mysql> set global transaction_isolation='READ-UNCOMMITTED';
   mysql> set global transaction_isolation='READ-COMMITTED';
   mysql> set global transaction_isolation='REPEATABLE-READ';
   
   # 查看事务隔离级别
   mysql> select @@transaction_isolation;
   +---------------------------------+
   | @@transaction_isolation |
   +---------------------------------+
   | READ-UNCOMMITTED         |
   +---------------------------------+
   
   mysql> select @@transaction_isolation;
   +---------------------------------+
   | @@transaction_isolation  |
   +---------------------------------+
   | READ-COMMITTED               |
   +---------------------------------+
   
   mysql> select @@transaction_isolation;
   +---------------------------------+
   | @@transaction_isolation |
   +---------------------------------+
   | REPEATABLE-READ             |
   +---------------------------------+
   
   # 临时关闭自动提交功能：
   mysql> set global autocommit=0;
   mysql> select @@autocommit;
   +---------------------+
   | @@autocommit |
   +---------------------+
   |                          0 |
   +---------------------+
   ~~~

   ## 2.并发事务问题

   

   



